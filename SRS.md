# 동화책 자동 인식 TTS 웹 앱 - 요구사항 명세서 (SRS)

## 1. 프로젝트 개요

### 1.1 목적
휴대폰 카메라를 이용하여 동화책을 자동으로 인식하고, 텍스트를 추출한 후 음성으로 재생해주는 웹 기반 애플리케이션

### 1.2 주요 기능
- 카메라 기반 책 페이지 인식 및 OCR 기반 텍스트 추출
- 책장 자동 감지 및 다음 페이지 자동 처리
- TTS를 통한 음성 재생
- 수동 페이지 로딩 기능
- 추출된 텍스트 저장 및 관리
- 텍스트 수정 기능
- 저장된 책 재생 기능

---

## 2. 기능 요구사항

### 2.1 카메라 및 이미지 캡처

#### FR-2.1.1 카메라 접근
- 사용자가 웹 앱에 접속하면 카메라 접근 권한을 요청
- iOS와 Android 모두 지원
- 카메라 권한 거부 시 안내 메시지 표시

#### FR-2.1.2 실시간 비디오 스트림
- 카메라에서 실시간으로 영상을 표시
- 전체 화면 또는 하단 절반 정도에 비디오 스트림 표시 가능
- 카메라 전환 기능 (후면 ↔ 전면)

#### FR-2.1.3 수동 사진 캡처
- 사용자가 버튼을 눌러 현재 카메라 화면을 사진으로 저장
- 캡처된 사진의 화질 최적화 (해상도: 1920x1080 이상)

---

### 2.2 텍스트 추출 (OCR)

#### FR-2.2.1 OCR 엔진 통합
- Google Vision API 또는 Tesseract.js를 사용하여 텍스트 추출
- 이미지에서 한글, 영어, 숫자 인식
- 추출 정확도를 위한 이미지 전처리 (명암 조정, 기울기 보정)

#### FR-2.2.2 자동 OCR 실행
- 카메라에서 책 페이지가 감지될 때 자동으로 OCR 실행
- 페이지가 "충분히 명확"한지 판별하는 신뢰도 점수 제공 (0-100%)
- 신뢰도가 60% 이상일 때만 자동으로 처리

#### FR-2.2.3 텍스트 추출 결과 표시
- 추출된 텍스트를 화면에 표시
- 추출 중 로딩 상태 표시
- 추출 완료 후 자동으로 TTS로 텍스트 음성 재생 시작
- 음성 재생 중 일시정지/중지 버튼 제공
- 사용자가 수동으로 재생 중지 후 다음 페이지로 이동 가능

---

### 2.3 책장 감지 (페이지 변경 인식)

#### FR-2.3.1 자동 페이지 변경 감지
- 카메라 영상의 프레임 간 차이(frame difference)를 분석하여 페이지 변경 감지
- 이미지 해시값 비교로 같은 페이지 반복 인식 방지

#### FR-2.3.2 페이지 변경 임계값
- 사용자가 설정 가능한 감지 민감도 조절
- 기본값: 중간 수준의 민감도

#### FR-2.3.3 페이지 변경 알림
- 페이지 변경 감지 시 진동 피드백 또는 음향 신호 제공 (사용자 설정 가능)
- "새 페이지가 감지되었습니다" 알림 표시

---

### 2.4 TTS (Text-to-Speech) 기능

#### FR-2.4.1 음성 합성
- Web Speech API 또는 Google Cloud TTS를 사용
- 자연스러운 음성 속도와 톤 제공
- 한글 음성 지원 필수

#### FR-2.4.2 음성 제어
- **자동 재생**: 페이지 텍스트 추출 완료 후 자동으로 음성 재생 (사용자 설정에서 활성화/비활성화 가능)
- **재생**: 현재 페이지의 텍스트 음성 재생 시작 (자동 재생 미활성화 시)
- **일시정지**: 음성 재생 일시정지
- **재개**: 일시정지된 음성 재개
- **중지**: 음성 재생 중지 (다음 페이지로 넘어가면 자동 중지)
- **속도 조절**: 0.5x ~ 2.0x (0.1x 단위)
- **음량 조절**: 0 ~ 100%

#### FR-2.4.3 음성 언어 및 음성 선택
- 한국어 음성 지원
- 여러 음성 캐릭터 선택 가능 (남성, 여성 등)
- 사용자 선호도 저장

#### FR-2.4.4 재생 상태 표시
- 현재 재생 중인 텍스트 하이라이트 표시
- 재생 진행률 표시 (프로그레스 바)
- 현재 재생 시간 / 전체 시간 표시

---

### 2.5 수동 페이지 로딩

#### FR-2.5.1 수동 캡처
- "사진 촬영" 버튼으로 현재 화면을 캡처하고 OCR 실행

#### FR-2.5.2 파일 업로드
- 사용자가 직접 이미지 파일을 선택하여 업로드
- 지원 형식: JPG, PNG, WebP (최대 크기: 10MB)

#### FR-2.5.3 수동 텍스트 입력
- 사용자가 직접 텍스트를 입력하거나 붙여넣기
- 빈 페이지 또는 OCR 실패 시 대체 수단

---

### 2.6 텍스트 저장 및 관리

#### FR-2.6.1 책 정보 저장
각 책마다 다음 정보 저장:
- 책 제목
- 저자
- 출판사
- 표지 이미지
- 총 페이지 수
- 생성 날짜 / 마지막 수정 날짜

#### FR-2.6.2 페이지별 텍스트 저장
각 페이지마다:
- 페이지 번호
- 원본 이미지 (썸네일 + 전체 이미지)
- 추출된 텍스트 (원본 및 수정된 버전 모두 저장)
- OCR 신뢰도 점수
- 생성 타임스탐프

#### FR-2.6.3 저장소
- **로컬 저장**: IndexedDB를 사용하여 브라우저에 저장 (용량 제한: 50MB 이상 권장)
- **클라우드 저장**: Firebase Firestore 또는 AWS DynamoDB를 사용하여 사용자 계정과 동기화 (선택사항)

#### FR-2.6.4 자동 저장
- 페이지 OCR 완료 후 자동 저장
- 사용자가 텍스트 수정 후 자동 저장 (3초 딜레이)

---

### 2.7 텍스트 수정 기능

#### FR-2.7.1 텍스트 편집 UI
- 추출된 텍스트를 편집 가능한 텍스트 에어리어에 표시
- 실시간 수정 가능

#### FR-2.7.2 텍스트 수정 내역 추적
- 원본 텍스트와 수정된 텍스트를 별도로 저장
- 수정 사용자 및 수정 시간 기록

#### FR-2.7.3 텍스트 되돌리기
- 수정 전 원본 텍스트로 되돌리기 기능
- 최근 수정 5개까지 히스토리 저장 및 복원 가능

#### FR-2.7.4 텍스트 검증
- 빈 텍스트 저장 방지
- 최소 1글자 이상 필수

---

### 2.8 저장된 책 재생

#### FR-2.8.1 책 목록 조회
- 저장된 모든 책의 목록 표시
- 책 표지 이미지, 제목, 저자 표시
- 정렬 옵션: 최근 수정순, 추가순, 제목순

#### FR-2.8.2 책 상세 조회
- 책의 모든 페이지를 페이지네이션 형태로 조회
- 각 페이지의 이미지 및 텍스트 표시

#### FR-2.8.3 책 재생
- 선택한 책의 첫 페이지부터 시작
- 페이지별로 TTS 음성 재생
- "이전/다음" 버튼으로 페이지 이동 중에 자동으로 TTS 재생

#### FR-2.8.4 북마크 기능
- 특정 페이지에 북마크 추가
- 마지막 읽은 페이지 자동 기억
- 북마크된 페이지로 빠른 이동

#### FR-2.8.5 책 관리
- 책 삭제
- 책 제목/저자 수정
- 책 복제

---

### 2.9 추가 기능

#### FR-2.9.1 언어 설정
- 사용자 인터페이스 언어: 한국어, 영어
- TTS 음성 언어: 한국어, 영어

#### FR-2.9.2 사용자 설정
- 카메라 해상도
- TTS 속도, 음량, 음성 선택
- TTS 자동 재생 활성화/비활성화
- 페이지 감지 민감도
- 진동/음향 피드백 활성화 여부
- 설정값 저장 및 복원

#### FR-2.9.3 오류 처리 및 재시도
- OCR 실패 시 사용자에게 알림
- 네트워크 오류 시 오프라인 모드 안내
- 재시도 기능

#### FR-2.9.4 성능 최적화
- 이미지 압축 및 캐싱
- 병렬 OCR 처리 (여러 프레임 동시 처리 금지, 최신 프레임만 처리)
- 메모리 누수 방지

---

## 3. 비기능 요구사항

### 3.1 성능
- **카메라 응답 시간**: 100ms 이내
- **OCR 처리 시간**: 2초 이내 (고해상도 이미지 기준)
- **TTS 로딩 시간**: 1초 이내 (캐시 후 즉시 재생)
- **페이지 로딩 시간**: 2초 이내

### 3.2 호환성
- **브라우저**: Chrome, Safari, Firefox (최신 2개 버전)
- **모바일 OS**: iOS 12+, Android 8.0+
- **화면 크기**: 모든 모바일 기기 해상도 지원 (반응형 디자인)

### 3.3 보안
- HTTPS 필수
- 사용자 데이터 암호화 (IndexedDB 데이터)
- 개인 정보 보호 (카메라 영상 저장 금지, 필요시만 임시 저장)
- API 키 보안 관리 (환경 변수 사용)

### 3.4 접근성
- 시각 장애인 지원: 스크린 리더 호환
- 청각 장애인 지원: 텍스트 기반 대안 제공
- 키보드 네비게이션 지원
- WCAG 2.1 Level AA 준수

### 3.5 확장성
- 마이크로서비스 아키텍처 고려
- OCR 엔진 플러그인 방식 지원
- TTS 엔진 플러그인 방식 지원

---

## 4. 사용 사례 (Use Cases)

### UC-1: 실시간 책 읽기
**주 사용자**: 부모
**흐름**:
1. 웹 앱 접속
2. "카메라로 책 읽기" 선택
3. 카메라 권한 허용
4. 책을 카메라에 비춤
5. 페이지 자동 감지 및 OCR 실행
6. 텍스트 자동 추출 및 TTS 음성 재생
7. 책장을 넘김
8. 다음 페이지 자동 감지 → 반복

### UC-2: 수동 페이지 로딩
**주 사용자**: 모든 사용자
**흐름**:
1. 자동 감지 실패 시
2. "수동으로 사진 촬영" 버튼 클릭
3. 사진 촬영 또는 이미지 업로드
4. 텍스트 추출 및 TTS 재생

### UC-3: 추출된 텍스트 수정
**주 사용자**: 모든 사용자
**흐름**:
1. 저장된 책의 페이지 조회
2. "편집" 버튼 클릭
3. 텍스트 수정
4. "저장" 클릭
5. 수정된 텍스트로 TTS 재생

### UC-4: 저장된 책 재생
**주 사용자**: 모든 사용자
**흐름**:
1. "저장된 책" 메뉴 접속
2. 책 목록 조회
3. 책 선택
4. "읽어주기" 버튼 클릭
5. 첫 페이지부터 음성 재생
6. "다음" 버튼으로 페이지 이동 시 자동으로 다음 텍스트 재생

---

## 5. 시스템 아키텍처 개요

### 5.1 기술 스택 (제안)
- **프론트엔드**: React.js + TypeScript
- **카메라**: getUserMedia API
- **OCR**: Tesseract.js (오프라인) 또는 Google Vision API (온라인)
- **TTS**: Web Speech API (기본) 또는 Google Cloud TTS (고급)
- **저장소**: IndexedDB (로컬) + Firebase/Supabase (클라우드, 선택)
- **상태 관리**: Redux 또는 Zustand
- **UI 프레임워크**: Material-UI 또는 Ant Design
- **빌드 도구**: Vite 또는 Next.js

### 5.2 주요 컴포넌트
1. **카메라 모듈**: 비디오 스트림, 캡처
2. **OCR 모듈**: 텍스트 추출, 신뢰도 점수
3. **TTS 모듈**: 음성 합성, 재생 제어
4. **페이지 감지 모듈**: 프레임 차이 분석
5. **저장소 모듈**: IndexedDB 관리
6. **UI 컴포넌트**: 카메라 뷰, 텍스트 에디터, 재생 컨트롤, 책 목록

---

## 6. 데이터 모델

### 6.1 Book (책)
```json
{
  "bookId": "unique-uuid",
  "title": "string",
  "author": "string",
  "publisher": "string",
  "coverImage": "blob",
  "totalPages": "number",
  "createdAt": "timestamp",
  "updatedAt": "timestamp",
  "pages": ["pageId1", "pageId2", ...]
}
```

### 6.2 Page (페이지)
```json
{
  "pageId": "unique-uuid",
  "bookId": "string",
  "pageNumber": "number",
  "originalImage": "blob",
  "thumbnailImage": "blob",
  "originalText": "string",
  "editedText": "string",
  "ocrConfidence": "number (0-100)",
  "createdAt": "timestamp",
  "editedAt": "timestamp",
  "editHistory": [
    {
      "version": "number",
      "text": "string",
      "editedAt": "timestamp"
    }
  ]
}
```

### 6.3 UserPreferences (사용자 설정)
```json
{
  "userId": "string",
  "uiLanguage": "ko | en",
  "ttsLanguage": "ko | en",
  "ttsVoice": "string",
  "ttsSpeed": "number (0.5-2.0)",
  "ttsVolume": "number (0-100)",
  "cameraResolution": "1080p | 720p | 480p",
  "pageSensitivity": "number (0-100)",
  "vibrationEnabled": "boolean",
  "soundEnabled": "boolean"
}
```

---

## 7. 제약사항 및 가정

### 7.1 제약사항
- 카메라는 HTTPS 환경에서만 작동
- IndexedDB 저장 용량은 브라우저 제한에 의존
- OCR 정확도는 이미지 품질에 따라 달라짐
- TTS는 대역폭이 필요함 (온라인 서비스 사용 시)

### 7.2 가정
- 사용자는 현대적 브라우저를 사용
- 사용자는 네트워크 연결이 있음 (OCR/TTS 온라인 서비스 사용 시)
- 카메라 환경이 적절함 (조명, 각도 등)
- 동화책은 한글 또는 영어로 작성됨

---

## 8. 향후 확장 기능 (Out of Scope)

- 다국어 지원 (중국어, 일본어 등)
- AI 기반 페이지 감지 (CNN 모델)
- 사용자 계정 및 로그인 시스템
- 책 공유 및 협업 기능
- 독서 통계 및 학습 추적
- 책 라이브러리 연동 (Google Books, 알라딘 등)
- 오프라인 TTS 모델 (큰 용량)
- AR 기반 페이지 시각화
